var U=Object.defineProperty,N=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var _=(o,e,i)=>e in o?U(o,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[e]=i,m=(o,e)=>{for(var i in e||(e={}))P.call(e,i)&&_(o,i,e[i]);if(S)for(var i of S(e))z.call(e,i)&&_(o,i,e[i]);return o},b=(o,e)=>N(o,F(e));import{_ as B,u as y,r as u,o as r,c as v,a,w as s,i as f,k as g,F as O,e as R,h,t as q}from"./entry-c6c6a655.mjs";import{u as E}from"./index-3349e9df.mjs";const G={props:{modelValue:{default:!1,type:[Boolean,Number,String,Object]},returnType:{default:"id"},label:{default:""},autoSave:{default:!0}},watch:{"$props.modelValue":{async handler(){this.placeFind()}}},methods:{emitValue(){this.returnType=="id"?this.$emit("update:modelValue",this.placeSave.data.id):this.returnType=="object"&&this.$emit("update:modelValue",m({},this.placeSave.data))},async setPlace(o){let e=typeof this.modelValue=="object"?this.modelValue.id:this.modelValue;e?(this.placeSave.data=b(m({},o),{id:e}),this.placeSave.submit()):this.placeSave.data=o,this.placesListShow=!1,this.emitValue()},async placeFind(){if(this.returnType=="id"){if(isNaN(this.modelValue))return;this.placeSave.data=(await this.$axios.get(`/api/places/find/${this.modelValue}`)).data}else this.returnType=="object"&&(this.placeSave.data=m({},this.modelValue||{}));this.mapRecenter()},placeAutosave(){this.autoSave&&this.placeSave.submit({debounce:3e3}),typeof this.modelValue=="object"&&this.emitValue()},mapRecenter(){setTimeout(()=>{console.log("mapRecenter"),this.$refs.map.leafletObject&&(!this.$refs.map.leafletObject.panTo||this.$refs.map.leafletObject.panTo([this.placeSave.data.lat||0,this.placeSave.data.lng||0]))},500)},updateLatLng(o){const e=m({},o.target._latlng);this._updateLatLngTimeout&&clearTimeout(this._updateLatLngTimeout),this._updateLatLngTimeout=setTimeout(()=>{this.$axios.get("/api/places/place-search",{params:e}).then(i=>{!i.data[0]||this.setPlace(i.data[0])})},500)},async getGeolocation(){const o={lat:this.geo.coords.latitude,lng:this.geo.coords.longitude};this.$axios.get("/api/places/place-search",{params:o}).then(e=>{!e.data[0]||this.setPlace(e.data[0])})}},async mounted(){this.placeFind()},data(){return{placesListShow:!1,places:y({method:"get",url:"/api/places/place-search",params:{q:""},resp:[]}),placeSave:y({method:"post",url:"/api/places/save",data:{}}),geo:E(),countries:[{value:"AF",title:"Afeganist\xE3o"},{value:"ZA",title:"\xC1frica do Sul"},{value:"AL",title:"Alb\xE2nia"}]}}},D={key:0,style:{position:"relative","z-index":"2"}},K=h(" Carregando resultados "),Z=h(" Nenhum item ");function H(o,e,i,I,t,n){const p=u("v-text-field"),c=u("v-list-item"),x=u("v-list"),L=u("v-card"),d=u("v-col"),k=u("v-autocomplete"),A=u("l-tile-layer"),T=u("l-marker"),w=u("l-map"),C=u("v-row");return r(),v("div",null,[a(C,null,{default:s(()=>[a(d,{cols:"12",md:"12"},{default:s(()=>[a(p,{label:t.placeSave.data.name||i.label,"hide-details":"",modelValue:t.places.params.q,"onUpdate:modelValue":e[0]||(e[0]=l=>t.places.params.q=l),onKeyup:e[1]||(e[1]=l=>t.places.submit({debounce:1500})),onFocus:e[2]||(e[2]=l=>t.placesListShow=!0),"prepend-inner-icon":"mdi-magnify","append-icon":"mdi-crosshairs","onClick:append":n.getGeolocation,loading:t.places.loading},null,8,["label","modelValue","onClick:append","loading"]),t.placesListShow?(r(),v("div",D,[a(L,{style:{background:"#fff",position:"absolute",width:"100%"}},{default:s(()=>[a(x,{"max-height":"300px"},{default:s(()=>[t.places.loading&&t.places.resp.length==0?(r(),f(c,{key:0},{default:s(()=>[K]),_:1})):g("",!0),!t.places.loading&&t.places.resp.length==0?(r(),f(c,{key:1},{default:s(()=>[Z]),_:1})):g("",!0),(r(!0),v(O,null,R(t.places.resp,(l,j)=>(r(),f(c,{key:j,onClick:V=>n.setPlace(l)},{default:s(()=>[h(q([l.route,l.district,l.city,l.state,l.country].filter(V=>V).join(", ")),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])):g("",!0)]),_:1}),a(d,{cols:"12",md:"8"},{default:s(()=>[a(p,{label:"Rua","hide-details":"",modelValue:t.placeSave.data.route,"onUpdate:modelValue":[e[3]||(e[3]=l=>t.placeSave.data.route=l),e[4]||(e[4]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(p,{label:"N\xB0","hide-details":"",modelValue:t.placeSave.data.number,"onUpdate:modelValue":[e[5]||(e[5]=l=>t.placeSave.data.number=l),e[6]||(e[6]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(p,{label:"Complemento","hide-details":"",modelValue:t.placeSave.data.complement,"onUpdate:modelValue":[e[7]||(e[7]=l=>t.placeSave.data.complement=l),e[8]||(e[8]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(p,{label:"CEP","hide-details":"",modelValue:t.placeSave.data.zipcode,"onUpdate:modelValue":[e[9]||(e[9]=l=>t.placeSave.data.zipcode=l),e[10]||(e[10]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(p,{label:"Bairro","hide-details":"",modelValue:t.placeSave.data.district,"onUpdate:modelValue":[e[11]||(e[11]=l=>t.placeSave.data.district=l),e[12]||(e[12]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(p,{label:"Cidade","hide-details":"",modelValue:t.placeSave.data.city,"onUpdate:modelValue":[e[13]||(e[13]=l=>t.placeSave.data.city=l),e[14]||(e[14]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(p,{label:"Estado","hide-details":"",modelValue:t.placeSave.data.state,"onUpdate:modelValue":[e[15]||(e[15]=l=>t.placeSave.data.state=l),e[16]||(e[16]=l=>n.placeAutosave())]},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"6"},{default:s(()=>[a(k,{label:"Pa\xEDs","hide-details":"",modelValue:t.placeSave.data.country_short,"onUpdate:modelValue":[e[17]||(e[17]=l=>t.placeSave.data.country_short=l),e[18]||(e[18]=l=>n.placeAutosave())],items:t.countries},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12"},{default:s(()=>[a(w,{ref:"map",zoom:18,center:[t.placeSave.data.lat||0,t.placeSave.data.lng||0],style:{height:"350px"}},{default:s(()=>[a(A,{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),a(T,{"lat-lng":[t.placeSave.data.lat||0,t.placeSave.data.lng||0],draggable:!0,onDragend:e[19]||(e[19]=l=>n.updateLatLng(l))},null,8,["lat-lng"])]),_:1},8,["center"])]),_:1})]),_:1})])}var W=B(G,[["render",H]]);export{W as _};
